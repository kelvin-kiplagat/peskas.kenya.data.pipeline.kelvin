<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Changelog • peskas.kenya.data.pipeline</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/IBM_Plex_Sans-0.4.10/font.css" rel="stylesheet"><link href="../deps/Fira_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/Alegreya_Sans_SC-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Changelog"><meta property="og:image" content="https://worldfishcenter.github.io/peskas.kenya.data.pipeline/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">peskas.kenya.data.pipeline</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-news">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Changelog</h1>

    </div>

    <div class="section level2">
<h2 class="pkg-version" data-toc-text="4.3.0" id="peskaskenyadatapipeline-430">peskas.kenya.data.pipeline 4.3.0<a class="anchor" aria-label="anchor" href="#peskaskenyadatapipeline-430"></a></h2>
<div class="section level3">
<h3 id="configuration-4-3-0">Configuration<a class="anchor" aria-label="anchor" href="#configuration-4-3-0"></a></h3>
<ul><li>
<strong>Environment-based Configuration</strong>:
<ul><li>Migrated authentication from file-based (<code>auth/</code>) to environment variable approach using <code>.env</code> files</li>
<li>Improved security and deployment flexibility by using environment variables for credentials</li>
<li>Added <code>.env.example</code> for reference configuration</li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="fixes-4-3-0">Fixes<a class="anchor" aria-label="anchor" href="#fixes-4-3-0"></a></h3>
<ul><li>
<strong>Package Quality and R CMD Check</strong>:
<ul><li>Fixed function naming conflict: renamed <code><a href="../reference/get_fishery_metrics.html">get_fishery_metrics()</a></code> in preprocessing.R to <code><a href="../reference/get_fishery_metrics_long.html">get_fishery_metrics_long()</a></code> to avoid duplicate function definitions</li>
<li>Corrected parameter names in helper functions (<code><a href="../reference/get_fishery_metrics.html">get_fishery_metrics()</a></code>, <code><a href="../reference/get_individual_metrics.html">get_individual_metrics()</a></code>, <code><a href="../reference/get_individual_gear_metrics.html">get_individual_gear_metrics()</a></code>) to match documentation</li>
<li>Resolved “unused arguments” error in <code><a href="../reference/export_summaries.html">export_summaries()</a></code> function calls</li>
<li>Updated function documentation to align with actual parameter names</li>
</ul></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="4.2.0" id="peskaskenyadatapipeline-420">peskas.kenya.data.pipeline 4.2.0<a class="anchor" aria-label="anchor" href="#peskaskenyadatapipeline-420"></a></h2>
<div class="section level3">
<h3 id="new-features-4-2-0">New features<a class="anchor" aria-label="anchor" href="#new-features-4-2-0"></a></h3>
<ul><li>
<strong>GPS Track Processing and Analysis</strong>:
<ul><li>Added <code>process_fishing_tracks()</code> for comprehensive GPS track processing and fishing activity classification</li>
<li>Implemented <code>prepare_gps_data()</code> to convert raw tracking data into GPSMonitoring format</li>
<li>Added <code>classify_fishing_activity()</code> using speed thresholds and spatial clustering to identify fishing vs transit activities</li>
<li>Created <code>process_trajectories_with_speed()</code> for calculating vessel speeds from GPS positions</li>
<li>Implemented <code>calculate_fishing_summaries()</code> to generate effort metrics by trip and spatial grid</li>
<li>Added <code>visualize_fishing_track()</code> for mapping fishing activities</li>
<li>Created <code>create_exclusion_zones()</code> and <code>create_extent_polygon()</code> for spatial analysis</li>
</ul></li>
<li>
<strong>Airtable Integration</strong>:
<ul><li>Implemented bidirectional Airtable API integration with <code><a href="../reference/airtable_to_df.html">airtable_to_df()</a></code> for reading records</li>
<li>Added <code><a href="../reference/df_to_airtable.html">df_to_airtable()</a></code> for bulk create operations</li>
<li>Created <code><a href="../reference/update_airtable_record.html">update_airtable_record()</a></code> for updating individual records</li>
<li>Implemented <code><a href="../reference/bulk_update_airtable.html">bulk_update_airtable()</a></code> for batch update operations</li>
<li>Added <code><a href="../reference/get_writable_fields.html">get_writable_fields()</a></code> to retrieve field schemas and validate writable fields</li>
</ul></li>
<li>
<strong>Fishery Metrics Expansion</strong>:
<ul><li>Extended <code><a href="../reference/get_fishery_metrics.html">get_fishery_metrics()</a></code> with normalized long format output for maximum interoperability</li>
<li>Added metrics for CPUE and RPUE by gear type</li>
<li>Implemented species composition analysis with top 2 species ranking</li>
<li>Created fully normalized dataset structure for flexible aggregation and filtering</li>
</ul></li>
<li>
<strong>PDS Tracker Report</strong>:
<ul><li>Added comprehensive GPS tracking visualization report (inst/reports/pds/trackers.qmd)</li>
<li>Integrated interactive maps, time series, and network analysis visualizations</li>
<li>Implemented spatial heatmaps and trip trajectory analysis</li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="enhancements-4-2-0">Enhancements<a class="anchor" aria-label="anchor" href="#enhancements-4-2-0"></a></h3>
<ul><li>
<strong>Package Quality and Compliance</strong>:
<ul><li>Fixed R CMD check warnings by replacing <code><a href="https://rdrr.io/r/base/library.html" class="external-link">library()</a></code>/<code><a href="https://rdrr.io/r/base/library.html" class="external-link">require()</a></code> calls with <code>::</code> notation and <code><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace()</a></code>
</li>
<li>Added missing global variable bindings for track and fishery metrics variables</li>
<li>Updated NAMESPACE with new imports: <code><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">dplyr::n</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">dplyr::arrange</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/row_number.html" class="external-link">dplyr::row_number</a></code>, <code><a href="https://rdrr.io/r/stats/lag.html" class="external-link">stats::lag</a></code>, <code><a href="https://rdrr.io/r/stats/time.html" class="external-link">stats::time</a></code>, <code><a href="https://rlang.r-lib.org/reference/sym.html" class="external-link">rlang::sym</a></code>
</li>
<li>Added GPSMonitoring and ggplot2 to Suggests dependencies</li>
<li>Excluded <code>.claude</code> directory and <code>.parquet</code> files from package build via .Rbuildignore</li>
<li>Reduced R CMD check from 3 warnings/6 notes to 2 warnings/2 notes</li>
</ul></li>
<li>
<strong>KEFS Data Integration</strong>:
<ul><li>Updated configuration (inst/config.yml) for KEFS survey data integration</li>
<li>Enhanced inst/kefs_integration.R with improved data processing workflows</li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="documentation-4-2-0">Documentation<a class="anchor" aria-label="anchor" href="#documentation-4-2-0"></a></h3>
<ul><li>Added 14 new man pages for GPS tracking functions:
<ul><li>
<code>process_fishing_tracks.Rd</code>, <code>prepare_gps_data.Rd</code>, <code>classify_fishing_activity.Rd</code>
</li>
<li>
<code>process_trajectories_with_speed.Rd</code>, <code>calculate_fishing_summaries.Rd</code>
</li>
<li>
<code>create_exclusion_zones.Rd</code>, <code>create_extent_polygon.Rd</code>, <code>visualize_fishing_track.Rd</code>
</li>
</ul></li>
<li>Added 6 new man pages for Airtable integration:
<ul><li>
<code>airtable_to_df.Rd</code>, <code>df_to_airtable.Rd</code>, <code>update_airtable_record.Rd</code>
</li>
<li>
<code>bulk_update_airtable.Rd</code>, <code>get_writable_fields.Rd</code>
</li>
</ul></li>
<li>Updated <code>get_fishery_metrics.Rd</code> to document dual function signatures for different use cases</li>
<li>Enhanced documentation with comprehensive examples and parameter descriptions</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="4.1.0" id="peskaskenyadatapipeline-410">peskas.kenya.data.pipeline 4.1.0<a class="anchor" aria-label="anchor" href="#peskaskenyadatapipeline-410"></a></h2>
<div class="section level3">
<h3 id="enhancements-4-1-0">Enhancements<a class="anchor" aria-label="anchor" href="#enhancements-4-1-0"></a></h3>
<ul><li>
<strong>Improved MongoDB Data Handling</strong>:
<ul><li>Enhanced <code><a href="../reference/mdb_collection_pull.html">mdb_collection_pull()</a></code> to properly handle MongoDB ObjectId fields by explicitly including <code>_id</code> in queries and maintaining correct column ordering</li>
<li>Updated column reordering logic to prioritize <code>_id</code> field placement in retrieved datasets</li>
<li>Improved data consistency and integrity when pulling data from MongoDB collections</li>
</ul></li>
<li>
<strong>Code Style and Formatting</strong>:
<ul><li>Standardized function parameter formatting across storage functions for improved readability</li>
<li>Enhanced code consistency in <code><a href="../reference/upload_parquet_to_cloud.html">upload_parquet_to_cloud()</a></code>, <code><a href="../reference/cloud_object_name.html">cloud_object_name()</a></code>, and related functions</li>
<li>Updated <code><a href="../reference/get_metadata.html">get_metadata()</a></code> function formatting to follow consistent style guidelines</li>
</ul></li>
<li>
<strong>User Management Infrastructure</strong>:
<ul><li>Added comprehensive user management system for MongoDB dashboard with treatment group support</li>
<li>Implemented secure password generation and user creation functionality</li>
<li>Added support for BMU-based user access control and role assignment</li>
</ul></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="3.2.1" id="peskaskenyadatapipeline-321">peskas.kenya.data.pipeline 3.2.1<a class="anchor" aria-label="anchor" href="#peskaskenyadatapipeline-321"></a></h2>
<div class="section level3">
<h3 id="new-features-3-2-1">New features<a class="anchor" aria-label="anchor" href="#new-features-3-2-1"></a></h3>
<ul><li>
<strong>Individual Fisher Metrics Data Extraction</strong>:
<ul><li>Added <code><a href="../reference/get_individual_gear_metrics.html">get_individual_gear_metrics()</a></code> to calculates gear key fishery performance metrics at the individual fisher level from validated catch data, including CPUE (Catch Per Unit Effort), RPUE (Revenue Per Unit Effort), price per kg, trip costs, and profit margins for each fisher.</li>
<li>Integrated the fish composition distribution at fishers level</li>
</ul></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="3.2.0" id="peskaskenyadatapipeline-320">peskas.kenya.data.pipeline 3.2.0<a class="anchor" aria-label="anchor" href="#peskaskenyadatapipeline-320"></a></h2>
<div class="section level3">
<h3 id="new-features-3-2-0">New features<a class="anchor" aria-label="anchor" href="#new-features-3-2-0"></a></h3>
<ul><li>
<strong>Individual Fisher Metrics Data Extraction</strong>:
<ul><li>Added <code><a href="../reference/get_individual_metrics.html">get_individual_metrics()</a></code> to calculates key fishery performance metrics at the individual fisher level from validated catch data, including CPUE (Catch Per Unit Effort), RPUE (Revenue Per Unit Effort), price per kg, trip costs, and profit margins for each fisher.</li>
</ul></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="3.1.0" id="peskaskenyadatapipeline-310">peskas.kenya.data.pipeline 3.1.0<a class="anchor" aria-label="anchor" href="#peskaskenyadatapipeline-310"></a></h2>
<div class="section level3">
<h3 id="new-features-3-1-0">New features<a class="anchor" aria-label="anchor" href="#new-features-3-1-0"></a></h3>
<ul><li>
<strong>Individual Fisher Data Extraction</strong>:
<ul><li>Added <code><a href="../reference/get_individual_data.html">get_individual_data()</a></code> to extract fisher IDs and trip costs from raw survey data, enabling more granular analysis of fishing effort and expenses.</li>
<li>Integrated individual fisher and trip cost data into the version 2 preprocessing pipeline (<code><a href="../reference/preprocess_landings_v2.html">preprocess_landings_v2()</a></code>), with new columns for <code>fisher_id</code> and <code>trip_cost</code> in preprocessed outputs.</li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="enhancements-3-1-0">Enhancements<a class="anchor" aria-label="anchor" href="#enhancements-3-1-0"></a></h3>
<ul><li>
<strong>Expanded Data Merging</strong>:
<ul><li>Updated <code><a href="../reference/merge_landings.html">merge_landings()</a></code> to support merging of legacy, v1, and v2 preprocessed landings, including new fields for individual fisher and trip cost data.</li>
<li>Improved column selection and ordering in merged datasets for consistency and downstream compatibility.</li>
</ul></li>
<li>
<strong>Export and Summarization Improvements</strong>:
<ul><li>Enhanced <code><a href="../reference/export_summaries.html">export_summaries()</a></code> to include new individual-level statistics, such as mean trip expenses per fisher, aggregated by BMU and month (for data collected after June 25, 2025).</li>
<li>Improved monthly and distribution summaries to reflect the expanded data model.</li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="configuration-3-1-0">Configuration<a class="anchor" aria-label="anchor" href="#configuration-3-1-0"></a></h3>
<ul><li>Updated <code>config.yml</code> to support new data paths and fields required for individual fisher and trip cost data in v2 surveys.</li>
</ul></div>
<div class="section level3">
<h3 id="documentation-3-1-0">Documentation<a class="anchor" aria-label="anchor" href="#documentation-3-1-0"></a></h3>
<ul><li>Added new man page for <code><a href="../reference/get_individual_data.html">get_individual_data()</a></code>.</li>
<li>Updated documentation for all affected functions to reflect new parameters and outputs.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="3.0.0" id="peskaskenyadatapipeline-300">peskas.kenya.data.pipeline 3.0.0<a class="anchor" aria-label="anchor" href="#peskaskenyadatapipeline-300"></a></h2>
<div class="section level3">
<h3 id="new-features-3-0-0">New features<a class="anchor" aria-label="anchor" href="#new-features-3-0-0"></a></h3>
<ul><li>
<strong>Versioned Survey Processing</strong>:
<ul><li>Added version-specific ingestion functions for catch and price surveys</li>
<li>Implemented <code><a href="../reference/ingest_catch_survey_version.html">ingest_catch_survey_version()</a></code> and <code><a href="../reference/ingest_price_survey_version.html">ingest_price_survey_version()</a></code> for versioned data handling</li>
<li>Created versioned preprocessing functions (<code><a href="../reference/preprocess_landings_v1.html">preprocess_landings_v1()</a></code> and <code><a href="../reference/preprocess_landings_v2.html">preprocess_landings_v2()</a></code>)</li>
<li>Added core preprocessing functions for modular data transformation</li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="enhancements-3-0-0">Enhancements<a class="anchor" aria-label="anchor" href="#enhancements-3-0-0"></a></h3>
<ul><li>
<strong>Improved Data Processing Pipeline</strong>:
<ul><li>Refactored ingestion logic to handle multiple survey versions</li>
<li>Enhanced preprocessing workflow with version-specific transformations</li>
<li>Updated configuration structure to support versioned data paths</li>
<li>Improved documentation for all versioned functions</li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="documentation-3-0-0">Documentation<a class="anchor" aria-label="anchor" href="#documentation-3-0-0"></a></h3>
<ul><li>Added comprehensive documentation for new versioned functions</li>
<li>Updated existing function documentation to reflect versioning changes</li>
<li>Added new man pages for version-specific functions</li>
<li>Enhanced function descriptions and examples</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.1.0" id="peskaskenyadatapipeline-210">peskas.kenya.data.pipeline 2.1.0<a class="anchor" aria-label="anchor" href="#peskaskenyadatapipeline-210"></a></h2>
<div class="section level3">
<h3 id="new-features-2-1-0">New features<a class="anchor" aria-label="anchor" href="#new-features-2-1-0"></a></h3>
<ul><li>
<strong>Geospatial Export Capabilities</strong>:
<ul><li>Added <code><a href="../reference/create_geos.html">create_geos()</a></code> function to generate GeoJSON files with regional-level fishery metrics</li>
<li>Implemented spatial analysis to assign BMUs to nearest coastal regions</li>
<li>Exported time series of aggregated metrics (CPUE, CPUA, effort, RPUE, RPUA) at regional level</li>
<li>Added regional polygon geometries for spatial visualization</li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="enhancements-2-1-0">Enhancements<a class="anchor" aria-label="anchor" href="#enhancements-2-1-0"></a></h3>
<ul><li>
<strong>Temporal Data Processing</strong>:
<ul><li>Revised fishery metrics calculation for more accurate temporal representation</li>
<li>Implemented daily-average approach instead of aggregate-then-divide method</li>
<li>Maintained per-day units (kg/fisher/day, KES/km²/day) consistent with scientific standards</li>
<li>Fixed CPUE and other daily metrics by calculating at daily level first</li>
<li>Filtered export data to include only records from 2023 onwards</li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="fixes-2-1-0">Fixes<a class="anchor" aria-label="anchor" href="#fixes-2-1-0"></a></h3>
<ul><li>
<strong>Data Quality Improvements</strong>:
<ul><li>Corrected handling of missing information with NA values instead of zeros</li>
<li>Fixed dependency logic of the pipeline</li>
<li>Improved price table prefix path handling</li>
<li>Updated configuration paths for downloading preprocessed price and legacy catch data</li>
</ul></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.0.0" id="peskaskenyadatapipeline-200">peskas.kenya.data.pipeline 2.0.0<a class="anchor" aria-label="anchor" href="#peskaskenyadatapipeline-200"></a></h2>
<div class="section level3">
<h3 id="new-features-2-0-0">New features<a class="anchor" aria-label="anchor" href="#new-features-2-0-0"></a></h3>
<ul><li>
<strong>Alternative Validation Method</strong>:
<ul><li>Added new validation functions using Interquartile Range (IQR) method:
<ul><li>
<code><a href="../reference/alert_outlier_iqr.html">alert_outlier_iqr()</a></code> for IQR-based outlier detection</li>
<li>
<code><a href="../reference/check_outliers_iqr.html">check_outliers_iqr()</a></code> for basic outlier checking</li>
<li>
<code><a href="../reference/validate_nfishers_iqr.html">validate_nfishers_iqr()</a></code> and <code><a href="../reference/validate_nboats_iqr.html">validate_nboats_iqr()</a></code> for validating fisher and boat counts</li>
<li>
<code><a href="../reference/validate_catch_iqr.html">validate_catch_iqr()</a></code> and <code><a href="../reference/validate_total_catch_iqr.html">validate_total_catch_iqr()</a></code> for catch validation</li>
<li>
<code><a href="../reference/get_catch_bounds_iqr.html">get_catch_bounds_iqr()</a></code> and <code><a href="../reference/get_total_catch_bounds_iqr.html">get_total_catch_bounds_iqr()</a></code> for calculating bounds</li>
</ul></li>
<li>Modified <code><a href="../reference/validate_landings.html">validate_landings()</a></code> to use IQR validation by default</li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="enhancements-2-0-0">Enhancements<a class="anchor" aria-label="anchor" href="#enhancements-2-0-0"></a></h3>
<ul><li>
<strong>Improved Error Handling</strong>:
<ul><li>Added comprehensive input validation in all IQR functions</li>
<li>Added consistent NULL/empty data checks</li>
<li>Improved NA value handling using dplyr::if_else</li>
<li>Added warnings for cases where bounds cannot be calculated</li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="documentation-2-0-0">Documentation<a class="anchor" aria-label="anchor" href="#documentation-2-0-0"></a></h3>
<ul><li>Added full documentation for all new IQR functions with examples</li>
<li>Updated NAMESPACE to export new IQR functions</li>
<li>Added proper Roxygen documentation for all new parameters</li>
</ul></div>
<div class="section level3">
<h3 id="other-changes-2-0-0">Other Changes<a class="anchor" aria-label="anchor" href="#other-changes-2-0-0"></a></h3>
<ul><li>Switched default validation method from MAD to IQR in main pipeline</li>
<li>Maintained backward compatibility with existing MAD functions</li>
</ul></div>
<div class="section level3">
<h3 id="new-features-2-0-0-1">New features<a class="anchor" aria-label="anchor" href="#new-features-2-0-0-1"></a></h3>
<ul><li>
<strong>Migration to Google Cloud Storage</strong>:
<ul><li>Replaced MongoDB storage with Google Cloud Storage (GCS) using Parquet files</li>
<li>Added new cloud storage functions for GCS operations:
<ul><li>Authentication and connection management</li>
<li>Upload and download capabilities</li>
<li>Versioned file handling</li>
</ul></li>
<li>Integrated Apache Arrow for efficient Parquet file processing</li>
<li>Updated configuration to support GCS file prefixes and paths</li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="enhancements-2-0-0-1">Enhancements<a class="anchor" aria-label="anchor" href="#enhancements-2-0-0-1"></a></h3>
<ul><li>
<strong>Storage Operations</strong>:
<ul><li>Refactored storage operations to use cloud-native approaches</li>
<li>Improved data access performance with Parquet file format</li>
<li>Added support for versioned file management</li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="dependencies-2-0-0">Dependencies<a class="anchor" aria-label="anchor" href="#dependencies-2-0-0"></a></h3>
<ul><li>Added cloud storage related libraries</li>
<li>Added Arrow for Parquet file handling</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.0.0" id="peskaskenyadatapipeline-100">peskas.kenya.data.pipeline 1.0.0<a class="anchor" aria-label="anchor" href="#peskaskenyadatapipeline-100"></a></h2>
<div class="section level3">
<h3 id="new-features-1-0-0">New features<a class="anchor" aria-label="anchor" href="#new-features-1-0-0"></a></h3>
<ul><li>
<strong>Catch Validation Enhancements</strong>:
<ul><li>Added <code><a href="../reference/validate_fishers_catch.html">validate_fishers_catch()</a></code> to flag cases where a single fisher reports an excessively high catch.</li>
<li>Introduced <code><a href="../reference/impute_price.html">impute_price()</a></code> to fill missing fish prices using median values across landing sites and sizes.</li>
<li>Integrated price validation in <code><a href="../reference/validate_landings.html">validate_landings()</a></code> to ensure missing or zero prices are flagged.</li>
</ul></li>
<li>
<strong>Revenue Metrics in Summaries</strong>:
<ul><li>
<code><a href="../reference/export_summaries.html">export_summaries()</a></code> now calculates revenue-based effort metrics:
<ul><li>
<code>rpue</code> (Revenue Per Unit Effort) as aggregated price per fisher</li>
<li>
<code>rpua</code> (Revenue Per Unit Area) as aggregated price per square km</li>
</ul></li>
</ul></li>
<li>
<strong>Extended Workflow Automation</strong>:
<ul><li>Updated GitHub Actions workflow (<code>data-pipeline.yaml</code>) to include a job for processing and merging price data.</li>
<li>Added price-related MongoDB collections (<code>raw_price</code>, <code>preprocessed_price</code>, <code>price_table</code>) to <code>config.yml</code>.</li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="enhancements-1-0-0">Enhancements<a class="anchor" aria-label="anchor" href="#enhancements-1-0-0"></a></h3>
<ul><li>
<strong>Improved Validation and Data Processing</strong>:
<ul><li>
<code><a href="../reference/validate_total_catch.html">validate_total_catch()</a></code> and <code><a href="../reference/validate_catch.html">validate_catch()</a></code> now allow customizable <code>flag_value</code> parameters.</li>
<li>Enhanced <code><a href="../reference/merge_prices.html">merge_prices()</a></code> with fixes for site name inconsistencies (e.g., “Rigati” → “Rigata”).</li>
<li>
<code><a href="../reference/preprocess_legacy_landings.html">preprocess_legacy_landings()</a></code> now ensures valid dates by correcting invalid timestamps.</li>
</ul></li>
<li>
<strong>Refined Data Summarization</strong>:
<ul><li>
<code><a href="../reference/export_summaries.html">export_summaries()</a></code> now includes revenue metrics while maintaining prior CPUE and CPUA calculations.</li>
<li>Updated <code>.qmd</code> reports to reflect new price fields in the summary tables.</li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="fixes-1-0-0">Fixes<a class="anchor" aria-label="anchor" href="#fixes-1-0-0"></a></h3>
<ul><li>
<strong>Bug Fixes and Consistency Improvements</strong>:
<ul><li>Fixed potential issues in <code><a href="../reference/merge_prices.html">merge_prices()</a></code> that could lead to duplicate price records.</li>
<li>Ensured <code><a href="../reference/impute_price.html">impute_price()</a></code> correctly applies median imputation across all relevant data points.</li>
<li>Updated <code>.Rd</code> documentation for all modified functions to reflect new parameters and changes.</li>
</ul></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.9.0" id="peskaskenyadatapipeline-090">peskas.kenya.data.pipeline 0.9.0<a class="anchor" aria-label="anchor" href="#peskaskenyadatapipeline-090"></a></h2>
<div class="section level3">
<h3 id="new-features-0-9-0">New features<a class="anchor" aria-label="anchor" href="#new-features-0-9-0"></a></h3>
<ul><li>
<strong>Price Data Integration</strong>: Added support for processing fish price data alongside catch data.
<ul><li>Introduced <code><a href="../reference/ingest_landings_price.html">ingest_landings_price()</a></code> to download price surveys from KoboToolbox.</li>
<li>Implemented <code><a href="../reference/preprocess_price_landings.html">preprocess_price_landings()</a></code> to clean and standardize fish price data.</li>
<li>Added <code><a href="../reference/merge_prices.html">merge_prices()</a></code> to combine and aggregate legacy and ongoing price data.</li>
<li>Created <code><a href="../reference/summarise_catch_price.html">summarise_catch_price()</a></code> to compute median price per kilogram by landing site and fish category.</li>
</ul></li>
<li>
<strong>Extended Workflow Automation</strong>:
<ul><li>Added a new GitHub Actions job <code>merge-price-data</code> to automate the processing and merging of price data.</li>
</ul></li>
<li>
<strong>Expanded MongoDB Collections</strong>:
<ul><li>Introduced new collections in <code>config.yml</code> for handling raw, preprocessed, and aggregated price data (<code>raw_price</code>, <code>preprocessed_price</code>, and <code>price_table</code>).</li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="enhancements-0-9-0">Enhancements<a class="anchor" aria-label="anchor" href="#enhancements-0-9-0"></a></h3>
<ul><li>
<strong>Validation and Alert Flagging</strong>:
<ul><li>Improved handling of validation alert flags by introducing dynamic <code>flag_value</code> parameters.</li>
<li>Adjusted anomaly detection in <code><a href="../reference/validate_landings.html">validate_landings()</a></code> to use more descriptive alert codes.</li>
</ul></li>
<li>
<strong>Configuration Updates</strong>:
<ul><li>Updated <code>.github/workflows/data-pipeline.yaml</code> to include price survey ingestion and processing.</li>
<li>Extended <code>config.yml</code> to support price data processing in both local and production environments.</li>
</ul></li>
<li>
<strong>Namespace Expansion</strong>:
<ul><li>Exported new functions (<code>ingest_landings_price</code>, <code>merge_prices</code>, <code>preprocess_price_landings</code>, <code>summarise_catch_price</code>) to make them available for package use.</li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="fixes-0-9-0">Fixes<a class="anchor" aria-label="anchor" href="#fixes-0-9-0"></a></h3>
<ul><li>
<strong>Documentation Corrections</strong>:
<ul><li>Updated <code>.Rd</code> documentation for <code><a href="../reference/ingest_landings.html">ingest_landings()</a></code> to clarify that it processes <strong>catch surveys</strong> (not all WCS surveys).</li>
<li>Added descriptions for new parameters (<code>flag_value</code>) in validation function documentation.</li>
</ul></li>
<li>
<strong>Bug Fixes</strong>:
<ul><li>Resolved inconsistencies in price data processing by ensuring column renaming and format standardization.</li>
<li>Fixed logical errors in merging price data to prevent duplicate records.</li>
<li>Improved MongoDB push operations to correctly handle newly introduced price data collections.</li>
</ul></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.8.0" id="peskaskenyadatapipeline-080">peskas.kenya.data.pipeline 0.8.0<a class="anchor" aria-label="anchor" href="#peskaskenyadatapipeline-080"></a></h2>
<div class="section level3">
<h3 id="new-features-0-8-0">New features<a class="anchor" aria-label="anchor" href="#new-features-0-8-0"></a></h3>
<ul><li>Introduced <code>flag_value</code> parameter to validation functions (<code>validate_dates</code>, <code>validate_nfishers</code>, <code>validate_nboats</code>, and <code>validate_catch</code>) for customizable alert thresholds.</li>
<li>Added <code>logical_check</code> and <code>anomalous_submissions</code> workflows to improve anomaly detection in <code>validate_landings</code>.</li>
<li>Enhanced data upload pipeline with <code><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">purrr::walk2</a></code> for streamlined MongoDB uploads of validated and flagged data.</li>
</ul></div>
<div class="section level3">
<h3 id="enhancements-0-8-0">Enhancements<a class="anchor" aria-label="anchor" href="#enhancements-0-8-0"></a></h3>
<ul><li>Updated <code>export_summaries</code> to calculate <code>mean_trip_catch</code> using the median for improved robustness against skewed data.</li>
<li>Improved documentation for validation functions to include detailed descriptions and examples for the new <code>flag_value</code> parameter.</li>
<li>Refined the logic in <code>validate_landings</code> for clearer alert flagging and better handling of edge cases.</li>
<li>Added the <code>validation_flags</code> collection to the configuration file (<code>config.yml</code>) for centralized management of flagging outputs.</li>
<li>Updated anomaly alert flags to use descriptive string values instead of numeric codes for better interpretability.</li>
</ul></div>
<div class="section level3">
<h3 id="fixes-0-8-0">Fixes<a class="anchor" aria-label="anchor" href="#fixes-0-8-0"></a></h3>
<ul><li>Fixed inconsistencies in the handling of alert flags during data validation.</li>
<li>Resolved potential mismatches in merged datasets by improving join logic in <code>validate_landings</code>.</li>
<li>Corrected documentation typos and improved consistency across <code>.Rd</code> files.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.7.0" id="peskaskenyadatapipeline-070">peskas.kenya.data.pipeline 0.7.0<a class="anchor" aria-label="anchor" href="#peskaskenyadatapipeline-070"></a></h2>
<div class="section level3">
<h3 id="new-features-0-7-0">New features<a class="anchor" aria-label="anchor" href="#new-features-0-7-0"></a></h3>
<ul><li>Introduced <code>get_total_catch_bounds</code> for calculating upper bounds on total catch data grouped by landing site and gear type.</li>
<li>Added <code>validate_total_catch</code> function for validating total catch data with improved outlier handling.</li>
<li>Updated <code>validate_landings</code> to identify and filter out inconsistent submissions (e.g., mismatched fishers and boats).</li>
<li>Enhanced <code>validate_catch</code> to set outlier values in <code>catch_kg</code> to NA and flag them for review.</li>
</ul></div>
<div class="section level3">
<h3 id="enhancements-0-7-0">Enhancements<a class="anchor" aria-label="anchor" href="#enhancements-0-7-0"></a></h3>
<ul><li>Improved <code>get_catch_bounds</code> to exclude invalid categories and clarified grouping logic for gear and fish categories.</li>
<li>Updated documentation across validation and catch bounds functions to include better descriptions, keywords, and return values.</li>
<li>Refined data preprocessing in <code>preprocess_landings</code> to ensure unique rows, handle NA values, and streamline workflow.</li>
<li>Adjusted configuration parameters in <code>config.yml</code> to enhance validation sensitivity (e.g., increasing <code>k_catch</code> for outlier detection).</li>
<li>Updated export_summaries to improve monthly summaries by recalculating effort as fishers per km² per day and refining CPUE and CPUA metrics to include temporal normalization. Simplified mean trip catch calculations for consistency across datasets.</li>
</ul></div>
<div class="section level3">
<h3 id="fixes-0-7-0">Fixes<a class="anchor" aria-label="anchor" href="#fixes-0-7-0"></a></h3>
<ul><li>Corrected plot code formatting in <code>data_report.qmd</code> for CPUE, effort, and CPUA visualizations.</li>
<li>Fixed documentation typos and inconsistencies in <code>.Rd</code> files for validation functions.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.6.0" id="peskaskenyadatapipeline-060">peskas.kenya.data.pipeline 0.6.0<a class="anchor" aria-label="anchor" href="#peskaskenyadatapipeline-060"></a></h2>
<div class="section level3">
<h3 id="new-features-0-6-0">New features<a class="anchor" aria-label="anchor" href="#new-features-0-6-0"></a></h3>
<ul><li>Add merge_landings function for combining data sources</li>
<li>Add validation catch function to improve data quality checks</li>
<li>Include form consent and total catch fields in merged data</li>
<li>Calculate total catch in legacy landings</li>
</ul></div>
<div class="section level3">
<h3 id="enhancements-0-6-0">Enhancements<a class="anchor" aria-label="anchor" href="#enhancements-0-6-0"></a></h3>
<ul><li>Homogenise gear and fish groups names</li>
<li>Update validation code structure</li>
<li>Fix mismatch between fish groups sum and total catch</li>
<li>Fix landing sites names</li>
<li>Improve validation catch function</li>
<li>Update export data based on validation</li>
<li>Fix legacy submission IDs</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.5.1" id="peskaskenyadatapipeline-051">peskas.kenya.data.pipeline 0.5.1<a class="anchor" aria-label="anchor" href="#peskaskenyadatapipeline-051"></a></h2>
<div class="section level3">
<h3 id="new-features-0-5-1">New features<a class="anchor" aria-label="anchor" href="#new-features-0-5-1"></a></h3>
<ul><li>Add functions to extract effort and CPUE from validated legacy data</li>
<li>Implement MongoDB pushing functionality</li>
<li>Add storage and metadata functions</li>
</ul></div>
<div class="section level3">
<h3 id="enhancements-0-5-1">Enhancements<a class="anchor" aria-label="anchor" href="#enhancements-0-5-1"></a></h3>
<ul><li>Index functions by topic and package functional position</li>
<li>Update package documentation and website</li>
<li>Improve MongoDB storage calls</li>
<li>Add configuration file for MongoDB database and collection references</li>
</ul></div>
<div class="section level3">
<h3 id="fixes-0-5-1">Fixes<a class="anchor" aria-label="anchor" href="#fixes-0-5-1"></a></h3>
<ul><li>Drop stale files</li>
<li>Update storage calls for better efficiency</li>
<li>Fix various typos and syntax errors</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.5.0" id="peskaskenyadatapipeline-050">peskas.kenya.data.pipeline 0.5.0<a class="anchor" aria-label="anchor" href="#peskaskenyadatapipeline-050"></a></h2>
<div class="section level3">
<h3 id="enhancements-0-5-0">Enhancements<a class="anchor" aria-label="anchor" href="#enhancements-0-5-0"></a></h3>
<ul><li>Improve mongoDB storage functions by adding indexes to improve query performance. Before this fix column order in data was not preserved.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.4.0" id="peskaskenyadatapipeline-040">peskas.kenya.data.pipeline 0.4.0<a class="anchor" aria-label="anchor" href="#peskaskenyadatapipeline-040"></a></h2>
<div class="section level3">
<h3 id="new-features-0-4-0">New features<a class="anchor" aria-label="anchor" href="#new-features-0-4-0"></a></h3>
<ul><li>Now <code>ingest_surveys()</code> uses Kobotoolbox API directly to download surveys instead of rely on R package</li>
</ul></div>
<div class="section level3">
<h3 id="fixes-0-4-0">Fixes<a class="anchor" aria-label="anchor" href="#fixes-0-4-0"></a></h3>
<ul><li>Fix ingestion functions as it was limited to download max 30,000 submissions. The approach now uses pagination to retrieve large datasets, with a limit of 30,000 records per request</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.3.0" id="peskaskenyadatapipeline-030">peskas.kenya.data.pipeline 0.3.0<a class="anchor" aria-label="anchor" href="#peskaskenyadatapipeline-030"></a></h2>
<div class="section level3">
<h3 id="new-features-0-3-0">New features<a class="anchor" aria-label="anchor" href="#new-features-0-3-0"></a></h3>
<ul><li>Add ingestion function to ingest ongoing data <code>ingest_surveys()</code>
</li>
<li>Add preprocessing function to preprocess ongoing data <code>preprocess_landings()</code>
</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.2.0" id="peskaskenyadatapipeline-020">peskas.kenya.data.pipeline 0.2.0<a class="anchor" aria-label="anchor" href="#peskaskenyadatapipeline-020"></a></h2>
<ul><li>Add package website with documentation functions</li>
<li>Integrate mongodb storage with package functions</li>
<li>Optimize configuration file</li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.1.0" id="peskaskenyadatapipeline-010">peskas.kenya.data.pipeline 0.1.0<a class="anchor" aria-label="anchor" href="#peskaskenyadatapipeline-010"></a></h2>
<ul><li>Initial CRAN submission.</li>
</ul></div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lorenzo Longobardi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

